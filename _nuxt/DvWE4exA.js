import"./1AO-i3Qm.js";import{E as r}from"./D_9vw2rQ.js";import{ai as x,r as T}from"./B91_JGNm.js";const E=x("conversation",()=>{const f=T([{id:1,title:"会话1",dataTime:new Date,isTop:!1},{id:2,title:"会话2这是一个很长的标题",dataTime:new Date,isTop:!0},{id:3,title:"会话3",dataTime:new Date,isTop:!1}]),n=T(null),y=()=>f.value?(n.value=g(f.value),f.value):null,b=()=>f.value?(n.value||(n.value=g(f.value)),n.value):null,g=d=>{const o={label:"置顶",data:[]},a={label:"今天",data:[]},i={label:"一周内",data:[]},e={label:"三十天内",data:[]},l={label:"更早",data:[]};d.forEach(t=>{if(t.isTop)o.data?.push(t);else{const m=Date.now(),p=t.dataTime.getTime(),u=m-p;u<=864e5?a.data?.push(t):u>864e5&&u<=6048e5?i.data?.push(t):u>6048e5&&u<=2592e6?e.data?.push(t):l.data?.push(t)}});let s=[o,a,i,e,l];return s=s.filter(t=>t.data&&t.data.length>0),s},h=d=>{const o=Date.now(),a=d.getTime(),i=o-a;return i<=864e5?"今天":i<=6048e5?"一周内":i<=2592e6?"三十天内":"更早"};return{getHistoryList:y,getLabelHistoryList:b,handleConversationTop:(d,o)=>{if(!n.value)return r({type:"error",title:"操作失败",message:"列表不存在"}),{isOk:!1,msg:"列表不存在"};const a=n.value.find(s=>s.label===d);if(!a||!a.data||a.data.length===0)return r({type:"error",title:"操作失败",message:"列表不存在"}),{isOk:!1,msg:"列表不存在"};const i=a.data.findIndex(s=>s.id===o);if(i===-1)return r({type:"error",title:"操作失败",message:"对象不存在"}),{isOk:!1,msg:"对象不存在"};const e=a.data[i];e.isTop=!e.isTop,a.data.splice(i,1);let l="";if(e.isTop){l="置顶成功";const s=n.value[0];if(!s||s.label!=="置顶"){const t={label:"置顶",data:[e]};n.value.unshift(t)}else s.data?s.data.push(e):s.data=[e]}else{l="取消置顶成功";const s=h(e.dataTime),t=n.value.find(m=>m.label===s);if(t)t.data?t.data.push(e):t.data=[e];else{const m={label:s,data:[e]},p=["置顶","今天","一周内","三十天内","更早"],u=p.findIndex(c=>c===s);let v=0;for(let c=0;c<n.value.length&&p.findIndex(I=>I===n.value[c].label)<u;c++)v=c+1;n.value.splice(v,0,m)}}if(a.data.length===0){const s=n.value.findIndex(t=>t.label===a.label);s!==-1&&n.value.splice(s,1)}return r({type:"success",title:"操作成功",message:l}),{isOk:!0,msg:l}},handleEditTitle:(d,o,a)=>{const i=d.trim();if(!i)return r({type:"error",title:"操作失败",message:"会话标题不能为空"}),{isOk:!1,msg:"会话标题不能为空"};if(!n.value)return r({type:"error",title:"操作失败",message:"会话历史列表不存在"}),{isOk:!1,msg:"会话历史列表不存在"};const e=n.value.find(t=>t.label===o);if(!e||!e.data||e.data.length===0)return r({type:"error",title:"操作失败",message:"会话历史列表不存在"}),{isOk:!1,msg:"会话历史列表不存在"};const l=e.data.findIndex(t=>t.id===a);if(l===-1)return r({type:"error",title:"操作失败",message:"对象不存在"}),{isOk:!1,msg:"对象不存在"};const s=e.data[l];return s.title=i,r({type:"success",title:"操作成功",message:"修改成功"}),{isOk:!0,msg:"修改成功"}},handleDelConversation:(d,o)=>{if(!n.value)return r({type:"error",title:"操作失败",message:"列表不存在"}),{isOk:!1,msg:"列表不存在"};const a=n.value.find(e=>e.label===o);if(!a||!a.data)return r({type:"error",title:"操作失败",message:"对象不存在"}),{isOk:!1,msg:"对象不存在"};const i=a.data.findIndex(e=>e.id===d);if(i===-1)return r({type:"error",title:"操作失败",message:"对象不存在"}),{isOk:!1,msg:"对象不存在"};if(a.data.splice(i,1),a.data.length===0){const e=n.value.findIndex(l=>l.label===a.label);e!==-1&&n.value.splice(e,1)}return r({type:"success",title:"操作成功",message:"删除成功"}),{isOk:!0,msg:"删除成功"}},getConversationById:d=>[{id:1,sender:"user",sendTime:Date.now(),content:"hello",contentType:"text"},{id:2,sender:"AI",sendTime:Date.now(),content:"你好啊，我是琛，是你的专属心理顾问",contentType:"text"},{id:3,sender:"user",sendTime:Date.now(),content:"你能做什么？",contentType:"text"},{id:4,sender:"AI",sendTime:Date.now(),content:"我可以陪你打三角洲，打MC，给你吃脆脆升，喝蜜雪冰城",contentType:"text"}]}});export{E as u};
